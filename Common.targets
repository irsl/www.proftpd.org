# $Id$
# Change at your own risk. This file is included by every Makefile in
# lspace.

html : $(HTMLFILES) $(EPLINCS)
ifneq "$(SUBDIRS)" ""
	@for i in $(SUBDIRS);  do $(MAKE) -j $(JOBS) -C $$i ; done
endif

css : $(CSSFILES) $(MACRODEFSF)
ifneq "$(SUBDIRS)" ""
	@for i in $(SUBDIRS);  do $(MAKE) -j $(JOBS) -C $$i ; done
endif

$(MACRODEFSF): $(MACRODEFS)
	m4 -P -F $(MACRODEFSF) $(MACRODEFS)


clean :
	rm -f $(HTMLFILES) $(CSSFILES)
	rm -f *~
ifneq "$(SUBDIRS)" ""
	@for i in $(SUBDIRS) ; do $(MAKE) -C $$i clean ; done
endif


install :
	$(INSTALL) $(SOURCEDIR) $(TARGETDIR) $(HTMLFILES) $(PICFILES) $(CSSFILES)
ifneq "$(SUBDIRS)" ""
	@for i in $(SUBDIRS) ; do $(MAKE) -C $$i install; done
endif
ifneq "$(SEPDIRS)" ""
	@for i in $(SEPDIRS) ; do cp -r $$i $(TARGETDIR); done
endif


FILES=$(wildcard *.html *.h4)

sub:
ifneq "$(FILES)" ""
	@for i in $(FILES) ; do echo Doing $$i...; $(HOME)/bin/ch $(HOME)/hhh $$i; done;
endif
ifneq "$(SUBDIRS)" ""
	@for i in $(SUBDIRS) ; do $(MAKE) -C $$i sub; done
endif

HTMLONLY=$(wildcard *.html)

weblint:
	@echo "Weblinting $(SOURCEDIR)"
ifneq "$(HTMLONLY)" ""
	@$(WEBLINT) $(HTMLONLY)
endif
ifneq "$(SUBDIRS)" ""
	@for i in $(SUBDIRS) ; do $(MAKE) -C $$i weblint; done
	@echo " "
endif

weblint-pedantic:
	@echo "Weblinting Pedantic $(SOURCEDIR)"
ifneq "$(HTMLONLY)" ""
	@$(WEBLINT) -pedantic -x netscape $(HTMLONLY)
endif
ifneq "$(SUBDIRS)" ""
	@for i in $(SUBDIRS) ; do $(MAKE) -C $$i weblint-pedantic; done
endif

weblint-ultra:
	@echo "Weblinting Ultra $(SOURCEDIR)"
ifneq "$(HTMLONLY)" ""
	@$(WEBLINT) -pedantic $(HTMLONLY)
endif
ifneq "$(SUBDIRS)" ""
	@for i in $(SUBDIRS) ; do $(MAKE) -C $$i weblint-ultra; done
	@echo " "
endif

validate:
	@echo "Checking $(SOURCEDIR)"
ifneq "$(HTMLONLY)" ""
	@$(HTMLCHECK) $(HTMLONLY)
endif
ifneq "$(SUBDIRS)" ""
	@for i in $(SUBDIRS) ; do $(MAKE) -C $$i validate; done
endif
